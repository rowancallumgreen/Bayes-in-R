aes(PercDom,str_split_i(Facet,"\\) ",1)))+
geom_point()+
facet_wrap(~str_split_i(Facet,"\\) ",2))+
geom_errorbar(orientation="y",aes(xmin=lower_CI,xmax=upper_CI))
ggplot(text%>%subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),
aes(PercDom,str_split_i(Facet,"\\) ",1)))+
geom_point()+
facet_wrap(~str_split_i(Facet,"\\) ",2))+
geom_errorbar(orientation="y",aes(xmin=lower_CI,xmax=upper_CI))
plot2df%>%subset(SegmentLabel!="max")%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)
plot2df%>%subset(SegmentLabel!="max")%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)%>%
arrange(SegmentLabel)%>%
ggplot(aes(9*rank/n,DVGness))+
geom_rect(data=text,ymin = 0, ymax = 50, aes(xmin = lower_CI, xmax = upper_CI),
fill = "darkgrey", alpha = 0.3, inherit.aes=F,color = NA)+
facet_wrap(~Facet,ncol=2)+
geom_point(aes(col=SegmentLabel))+
geom_point(aes(col=SegmentLabel),
data=plot2df%>%subset(SegmentLabel=="max"))+
scale_colour_manual(values=c(Colours,'darkgrey'),name="Segment",
breaks=c(RefLengths$Segment,
"max")) +
ylab("DVG abundance (%)")+
xlab("Sample percentile")+
scale_x_reverse(breaks=c(0,25,50,75,100)/100,
labels=c(paste0(seq(100,25,length=4),"th"),"1st"))+
scale_y_continuous(breaks=c(0,25,50,75,100),
labels=paste0(c(0,25,50,75,100),"%"))+
theme(legend.position = "none")+
geom_segment(data=text,inherit.aes = F,
aes(x=0,xend=PercDom,
y=50,yend=50),lty=2)+
geom_segment(data=text,inherit.aes = F,
aes(x=PercDom,xend=PercDom,
y=0,yend=50),lty=2)+
theme(
axis.title = element_text(face = "bold"),
axis.text = element_text(face = "bold"),
strip.text = element_text(face = "bold",size=12),# For facet labels
strip.background = element_rect(fill = "white", color = "black")
)->Fig2B
plot2df%>%subset(SegmentLabel!="max")%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)%>%
arrange(SegmentLabel)%>%
ggplot(aes(9*rank/n,DVGness))+
geom_rect(data=text,ymin = 0, ymax = 50, aes(xmin = lower_CI, xmax = upper_CI),
fill = "darkgrey", alpha = 0.3, inherit.aes=F,color = NA)+
facet_wrap(~Facet,ncol=2)+
geom_point(aes(col=SegmentLabel))+
geom_point(aes(col=SegmentLabel),
data=plot2df%>%subset(SegmentLabel=="max"))+
scale_colour_manual(values=c(Colours,'darkgrey'),name="Segment",
breaks=c(RefLengths$Segment,
"max")) +
ylab("DVG abundance (%)")+
xlab("Sample percentile")+
scale_x_reverse(breaks=c(0,25,50,75,100)/100,
labels=c(paste0(seq(100,25,length=4),"th"),"1st"))+
scale_y_continuous(breaks=c(0,25,50,75,100),
labels=paste0(c(0,25,50,75,100),"%"))+
theme(legend.position = "none")+
geom_segment(data=text,inherit.aes = F,
aes(x=0,xend=PercDom,
y=50,yend=50),lty=2)+
geom_segment(data=text,inherit.aes = F,
aes(x=PercDom,xend=PercDom,
y=0,yend=50),lty=2)+
theme(
axis.title = element_text(face = "bold"),
axis.text = element_text(face = "bold"),
strip.text = element_text(face = "bold",size=12),# For facet labels
strip.background = element_rect(fill = "white", color = "black")
)->Fig2B_SUP
Fig2B_SUP
ggsave("Figure2_sup.png",
Fig2B_SUP,units="in",width=12,height=36)
plot2df%>%subset(SegmentLabel!="max")%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)%>%
arrange(SegmentLabel)%>%
ggplot(aes(9*rank/n,DVGness))+
geom_rect(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),ymin = 0, ymax = 50, aes(xmin = lower_CI, xmax = upper_CI),
fill = "darkgrey", alpha = 0.3, inherit.aes=F,color = NA)+
facet_wrap(~Facet,ncol=2)+
geom_point(aes(col=SegmentLabel))+
geom_point(aes(col=SegmentLabel),
data=plot2df%>%subset(SegmentLabel=="max"))+
scale_colour_manual(values=c(Colours,'darkgrey'),name="Segment",
breaks=c(RefLengths$Segment,
"max")) +
ylab("DVG abundance (%)")+
xlab("Sample percentile")+
scale_x_reverse(breaks=c(0,25,50,75,100)/100,
labels=c(paste0(seq(100,25,length=4),"th"),"1st"))+
scale_y_continuous(breaks=c(0,25,50,75,100),
labels=paste0(c(0,25,50,75,100),"%"))+
theme(legend.position = "none")+
geom_segment(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),inherit.aes = F,
aes(x=0,xend=PercDom,
y=50,yend=50),lty=2)+
geom_segment(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),inherit.aes = F,
aes(x=PercDom,xend=PercDom,
y=0,yend=50),lty=2)+
theme(
axis.title = element_text(face = "bold"),
axis.text = element_text(face = "bold"),
strip.text = element_text(face = "bold",size=12),# For facet labels
strip.background = element_rect(fill = "white", color = "black")
)->Fig2B_SUP
ggsave("Figure2_sup.png",
Fig2B_SUP,units="in",width=12,height=36)
data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)
plot2df%>%subset(SegmentLabel!="max")%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)%>%
arrange(SegmentLabel)%>%
ggplot(aes(9*rank/n,DVGness))+
geom_rect(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),ymin = 0, ymax = 50, aes(xmin = lower_CI, xmax = upper_CI),
fill = "darkgrey", alpha = 0.3, inherit.aes=F,color = NA)+
facet_wrap(~Facet,ncol=5)+
geom_point(aes(col=SegmentLabel))+
geom_point(aes(col=SegmentLabel),
data=plot2df%>%subset(SegmentLabel=="max"))+
scale_colour_manual(values=c(Colours,'darkgrey'),name="Segment",
breaks=c(RefLengths$Segment,
"max")) +
ylab("DVG abundance (%)")+
xlab("Sample percentile")+
scale_x_reverse(breaks=c(0,25,50,75,100)/100,
labels=c(paste0(seq(100,25,length=4),"th"),"1st"))+
scale_y_continuous(breaks=c(0,25,50,75,100),
labels=paste0(c(0,25,50,75,100),"%"))+
theme(legend.position = "none")+
geom_segment(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),inherit.aes = F,
aes(x=0,xend=PercDom,
y=50,yend=50),lty=2)+
geom_segment(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),inherit.aes = F,
aes(x=PercDom,xend=PercDom,
y=0,yend=50),lty=2)+
theme(
axis.title = element_text(face = "bold"),
axis.text = element_text(face = "bold"),
strip.text = element_text(face = "bold",size=12),# For facet labels
strip.background = element_rect(fill = "white", color = "black")
)->Fig2B_SUP
ggsave("Figure2_sup.png",
Fig2B_SUP,units="in",width=36,height=36)
plot2df%>%subset(SegmentLabel!="max")%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)%>%
arrange(SegmentLabel)%>%
ggplot(aes(9*rank/n,DVGness))+
geom_rect(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),ymin = 0, ymax = 50, aes(xmin = lower_CI, xmax = upper_CI),
fill = "darkgrey", alpha = 0.3, inherit.aes=F,color = NA)+
facet_wrap(~Facet,ncol=5)+
geom_point(aes(col=SegmentLabel))+
geom_point(aes(col=SegmentLabel),
data=plot2df%>%subset(SegmentLabel=="max")%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30))+
scale_colour_manual(values=c(Colours,'darkgrey'),name="Segment",
breaks=c(RefLengths$Segment,
"max")) +
ylab("DVG abundance (%)")+
xlab("Sample percentile")+
scale_x_reverse(breaks=c(0,25,50,75,100)/100,
labels=c(paste0(seq(100,25,length=4),"th"),"1st"))+
scale_y_continuous(breaks=c(0,25,50,75,100),
labels=paste0(c(0,25,50,75,100),"%"))+
theme(legend.position = "none")+
geom_segment(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),inherit.aes = F,
aes(x=0,xend=PercDom,
y=50,yend=50),lty=2)+
geom_segment(data=text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30),inherit.aes = F,
aes(x=PercDom,xend=PercDom,
y=0,yend=50),lty=2)+
theme(
axis.title = element_text(face = "bold"),
axis.text = element_text(face = "bold"),
strip.text = element_text(face = "bold",size=12),# For facet labels
strip.background = element_rect(fill = "white", color = "black")
)->Fig2B_SUP
ggsave("Figure2_sup.png",
Fig2B_SUP,units="in",width=36,height=36)
ggsave("Figure2_sup.png",
Fig2B_SUP,units="in",width=18,height=18)
ggsave("Figure2_sup.png",
Fig2B_SUP,units="in",width=24,height=16)
text%>%
subset(!is.na(str_split_i(Facet,"\\) ",2))&
!grepl("Not assigned",str_split_i(Facet,"\\) ",2))&
!grepl("Minor",str_split_i(Facet,"\\) ",2))&
n/9>30)%>%arrange(PercDom)
#| label: packages & data
library(tidyverse)
library(magrittr)
library(PNWColors)
theme_set(theme_bw(base_family="mono",base_size=18))
options(ggplot2.discrete.colour= list(c("red", "blue"),
c(pnw_palette("Sunset",7),pnw_palette("Sailboat",6),
pnw_palette("Lake",8)[-(1:2)]),
colors()))
library(Matrix)
library(gridExtra)
library(emdbook)
library(ggbeeswarm)
library(plotly)
library(emmeans)
library(ggrepel)
library(broom)
library("fields")
library(ggrepel)
#Getting the reference for segment lengths
library(seqinr)
library(Biostrings)
readDNAStringSet("H5N1_base_reference.fasta")->Ref
width(Ref)->Length
names(Ref)->SegmentName
cbind(Length,SegmentName)%>%as.data.frame()->RefLengths
RefLengths%<>%mutate(Segment=str_split_i(SegmentName,"\\|",1))
#RefLengths%>%write_csv("H5N1_base_reference.csv")
read_delim("FluDVG_Dataset_Report_22Sept25_HostGroups.tsv")->ARdata
ARdata%>%dplyr::select(Run,starts_with("MVs"))->MinorVariants
MinorVariants%>%separate_wider_delim(starts_with("MVs"),
delim=",",
names_sep="_",
names=as.character(1:301),
too_few="align_start")->MinorVariants_wide
str_count(MinorVariants$`MVs:PB1`,",")%>%max()
str_count(MinorVariants$`MVs:PA`,",")%>%max()
str_count(MinorVariants$`MVs:PB2`,",")%>%max()
str_count(MinorVariants$`MVs:MP`,",")%>%max()
str_count(MinorVariants$`MVs:NP`,",")%>%max()
str_count(MinorVariants$`MVs:HA`,",")%>%max()
str_count(MinorVariants$`MVs:NA`,",")%>%max()
str_count(MinorVariants$`MVs:NS`,",")%>%max()
MinorVariants_wide%>%pivot_longer(cols=starts_with("MVs"),
names_to="Segment",values_to="Variant",
values_drop_na = T)->MinorVariants_long
MinorVariants_long%<>%subset(Variant!="{}")
MinorVariants_long%<>%mutate(Variant=gsub("\\{","",Variant))
MinorVariants_long%<>%mutate(Variant=gsub("\\}","",Variant))
MinorVariants_long%<>%separate_wider_delim(Variant,delim=": ",names=c("Mutation","Frequency"))
MinorVariants_long$Frequency%<>%as.numeric()
hist(MinorVariants_long$Frequency)
max(MinorVariants_long$Frequency)
MinorVariants_long%<>%mutate(Segment=gsub("MVs:","",Segment))
MinorVariants_long%<>%mutate(Segment=str_split_i(Segment,"_",1))
MinorVariants_long%<>%mutate(Mutation=str_split_i(Mutation,"'",2))
MinorVariants_long%>%dplyr::group_by(Run,Segment)%>%tally()%>%
ggplot(aes(Segment,n))+geom_violin()+geom_jitter()+
ylab("Variants")
MinorVariants_long%>%dplyr::group_by(Run,Segment)%>%tally()%>%
merge(RefLengths,by="Segment")%>%
ggplot(aes(Segment,1000*n/as.numeric(Length)))+geom_violin()+geom_jitter()+
ylab("Variants / kp")
MinorVariants_long%<>%separate_wider_delim(delim=stringr::regex("\\d+"),
cols=Mutation,
names=c("Ref","Alt"),cols_remove = F)
nchar(MinorVariants_long$Ref)%>%max()#always 1 nt
MinorVariants_long$Class<-NA
MinorVariants_long$Class[grepl("+",MinorVariants_long$Alt)]<-"Microindel"
MinorVariants_long$Class[grepl("-",MinorVariants_long$Alt)]<-"Microindel"
MinorVariants_long$Class[nchar(MinorVariants_long$Alt)==1]<-"BPS"
MinorVariants_long$Class%>%table()
#Far more BPS than micro indels
nchar(MinorVariants_long$Alt)%>%max()
subset(MinorVariants_long,nchar(Alt)==97)
hist(nchar(MinorVariants_long$Alt[MinorVariants_long$Class=="Microindel"]))
#indels larger than 30bp are included though largest is 96 bp
MinorVariants_long%>%subset(Frequency>0.01&Frequency<0.99)%>%dplyr::group_by(Class,Run)%>%tally()->VariantCounts
#merge back on any samples with 0 at this point
expand.grid(ARdata$Run,c("BPS","Microindel"))%>%as.data.frame()->AllSamples
names(AllSamples)<-c("Run","Class")
merge(AllSamples, VariantCounts, by=c("Run","Class"),all = TRUE)->VariantCounts
VariantCounts$n[is.na(VariantCounts$n)]<-0
VariantCounts%>%
ggplot(aes(n,fill=Class))+
geom_histogram(position="identity",alpha=0.5,breaks=c(0.5-26.375,seq(0.5,max(VariantCounts$n),length=29)))
MinorVariants_long$Frequency_minor<-MinorVariants_long$Frequency
MinorVariants_long$Frequency_minor[MinorVariants_long$Frequency>0.5]<-1-MinorVariants_long$Frequency[MinorVariants_long$Frequency>0.5]
plot(MinorVariants_long$Frequency_minor~MinorVariants_long$Frequency)
ggplot(MinorVariants_long,aes(Frequency_minor))+geom_histogram(aes(fill=Class),alpha=0.5,position="identity")
MinorVariants_long%>%head()
MinorVariants_long%>%subset(Class="BPS")%>%mutate(POS=substr(Mutation,2,nchar(Mutation)-1))->SNPS
MinorVariants_long%>%subset(Class=="BPS")%>%mutate(POS=substr(Mutation,2,nchar(Mutation)-1))->SNPS
SNPS%>%head()
MinorVariants_long%>%subset(Class=="BPS")%>%mutate(POS=as.numeric(substr(Mutation,2,nchar(Mutation)-1)))->SNPS
SNPS%>%head()
ggplot(SNPS,aes(POS,Frequency))+geom_point(shape='.')+facet_wrap(~Segment)
ggplot(SNPS,aes(POS,Frequency_minor))+geom_point(shape='.')+facet_wrap(~Segment)
ggplot(SNPS,aes(POS,Frequency_minor))+geom_point(shape='.')+facet_wrap(~Segment,scales="free_x",ncol=4)
floor(5674/1e3)
SNPS%>%mutate("Kb_zone"=floor(POS/1e3))%>%dplyr::group_by(Kb_zone,Segment)%>%
tally()%>%
ggplot(aes(Segment,n))+
geom_col(aes(fill=Kb_zone))+
scale_fill_brewer(palette="Spectral")
SNPS%>%mutate("Kb_zone"=as.factor(floor(POS/1e3)))%>%dplyr::group_by(Kb_zone,Segment)%>%
tally()%>%
ggplot(aes(Segment,n))+
geom_col(aes(fill=Kb_zone))+
scale_fill_brewer(palette="Spectral")
SNPS%>%dplyr::group_by(Segment,Mutation)%>%tally()%>%arrange(desc(n))%>%head()
install.packages("rstan")
install.packages(c("coda","mvtnorm","devtools","dagitty"))
install.packages(c("coda","mvtnorm","devtools","dagitty"))
install.packages(c("coda", "mvtnorm", "devtools", "dagitty"))
library(devtools)
devtools::install_github("rmcelreath/rethinking")
library(rstan)
devtools::install_github("rmcelreath/rethinking")
install.packages(c('coda','mvtnorm')) options(repos=c(getOption('repos'),rethinking='http://xcelab.net/R'))
install.packages(c('coda','mvtnorm'))
options(repos=c(getOption('repos'),rethinking='http://xcelab.net/R'))
install.packages('rethinking',type='source')
library(rethinking)
---
title: "Rstan/bayes"
---
title: "Rstan and bayes"
---
title: "Rstan and bayes"
#| label: from stat rethinking chapter 2
## R code 2.1
ways <- c( 0 , 3 , 8 , 9 , 0 )
ways/sum(ways)
## R code 2.2
dbinom( 6 , size=9 , prob=0.5 )
## R code 2.3
# define grid
p_grid <- seq( from=0 , to=1 , length.out=20 )
# define prior
prior <- rep( 1 , 20 )
# compute likelihood at each value in grid
likelihood <- dbinom( 6 , size=9 , prob=p_grid )
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
## R code 2.4
plot( p_grid , posterior , type="b" ,
xlab="probability of water" , ylab="posterior probability" )
mtext( "20 points" )
plot( p_grid , posterior , type="b" ,
xlab="probability of water" , ylab="posterior probability" )
mtext( "20 points" )
dbinom(1, size=3,prob=0.5)
ways/sum(ways)
#May need xcode app and xcode-select --install to be run in command line
#install.packages("rstan")
#install.packages(c("coda","mvtnorm","devtools","dagitty"))
#library(devtools)
#library(rstan)
#install.packages(c('coda','mvtnorm'))
#options(repos=c(getOption('repos'),rethinking='http://xcelab.net/R'))
#install.packages('rethinking',type='source')
library(rethinking)
parallel::detectCores()
options(mc.cores = (parallel::detectCores()-2))
#ways to observe WLW under the reality of pW=0,0.25,0.5,0.75,1
ways <- c( 0 , 3 , 8 , 9 , 0 )
#Relative plausibility or LIKELIHOOD? (am I getting this right)
ways/sum(ways)
## R code 2.2
#Rather than a specific sequence we now consider 6 'success' from 9 'trials' and get the likelihood of that under equal chance of success and failure
dbinom( 6 , size=9 , prob=0.5 )
## R code 2.3
# define grid - values at which to calculate posterior
p_grid <- seq( from=0 , to=1 , length.out=20 )
# define prior -
prior <- rep( 1 , 20 )
# compute likelihood at each value in grid
likelihood <- dbinom( 6 , size=9 , prob=p_grid )
# compute product of likelihood and prior
unstd.posterior <- likelihood * prior
# standardize the posterior, so it sums to 1
sum(unstd.posterior)
posterior <- unstd.posterior / sum(unstd.posterior)
sum(posterior)
plot( p_grid , posterior , type="b" ,
xlab="probability of water" , ylab="posterior probability" )
mtext( "20 points" )
install.packages("brms")
install.packages("brms")
library(brms)
options(mc.cores = (parallel::detectCores()-2))
fit1 <- brm(count ~ zAge + zBase * Trt + (1|patient),
data = epilepsy, family = poisson())
R.version
Sys.getenv("CC")
Sys.getenv("CXX17")
R.version.string
fit1 <- brm(count ~ zAge + zBase * Trt + (1|patient),
data = epilepsy, family = poisson(),cores=1)
remotes::install_github("coatless-mac/macrtools")
gitcreds::gitcreds_set()
remotes::install_github("coatless-mac/macrtools")
macrtools::macos_rtools_install()
macrtools::is_xcode_cli_installed()
macrtools::is_gfortran_installed()
macrtools::is_xcode_app_installed()
Sys.getenv("CC")
library(brms)
fit1 <- brm(count ~ zAge + zBase * Trt + (1|patient),
data = epilepsy, family = poisson(),cores=1)
macrtools::is_xcode_cli_installed()
library(brms)
fit1 <- brm(count ~ zAge + zBase * Trt + (1|patient),
data = epilepsy, family = poisson(),cores=1)
macrtools::xcode_cli_uninstall()
macrtools::macos_rtools_install()
macrtools::is_xcode_cli_installed()
macrtools::is_gfortran_installed()
macrtools::is_xcode_app_installed()
macrtools::xcode_cli_install()
macrtools::is_xcode_cli_installed()
macrtools::is_gfortran_installed()
macrtools::is_xcode_cli_installed()
remove.packages("rstan")
if (file.exists(".RData")) file.remove(".RData")
install.packages("rstan")
example(stan_model, package = "rstan", run.dontrun = TRUE)
Sys.setenv(USE_CXX14=1)
example(stan_model, package = "rstan", run.dontrun = TRUE)
library(inline)
library(Rcpp)
src <- '
src <- '
std::vector<std::string> s;
src <- ' std::vector<std::string> s;
example(stan_model, package = "rstan", run.dontrun = TRUE)
#Testing Rcpp
Rcpp::sourceCpp(code="
#include <Rcpp.h>
using namespace Rcpp;
// [[Rcpp::export]]
NumericVector timesTwo(NumericVector x) {
return x * 2;
}
")
timesTwoR <- function(x) {
2 * x
}
resCpp <- timesTwo(42)
resR <- timesTwoR(42)
all.equal(resCpp, resR)
rt <- stanc("Programs/lm.stan")
Sys.which("gcc")
macrtools::macos_rtools_install()
